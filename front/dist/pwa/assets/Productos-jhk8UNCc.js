import{g as me,r as oe,x as b,a1 as ve,S as fe,W as ye,j as Q,v as xe,ar as be,as as _e,at as Ie,au as Ve,av as we,aw as Ce,ax as le,ay as Ne,az as qe,a0 as Pe,_ as ke,c as S,o as f,w as r,b as s,a as l,f as V,af as F,d as Z,a9 as N,a8 as p,ab as $,ac as ee,t as g,aa as P,Q as W,e as z,aq as te,aA as Se,ag as ne,h as ae,ah as Fe,aB as Qe,aC as ze}from"./index-D2Z3lgRK.js";import{Q as D}from"./QSpace-n8o2liL3.js";import{Q as q}from"./QChip-BSLZ8Baf.js";import{Q as re}from"./QBadge-DEd0qZch.js";import{Q as ue}from"./QInnerLoading-De0xBfTN.js";import{Q as de}from"./QSelect-DfEOIbho.js";import{h as Ue}from"./format-KGr3QpCO.js";import{Q as Ae}from"./QForm-CFsU35Ix.js";import{Q as Be}from"./QMarkupTable-DEdMIXu9.js";import{Q as De,b as ce,a as Te}from"./QItem-hbtxYLQf.js";import{Q as Le}from"./QPage-DPU8kwmd.js";import"./position-engine-BA0I2poh.js";function U(e,t,v,I){const i=[];return e.forEach(n=>{I(n)===!0?i.push(n):t.push({failedPropValidation:v,file:n})}),i}function G(e){e?.dataTransfer&&(e.dataTransfer.dropEffect="copy"),fe(e)}const Me={multiple:Boolean,accept:String,capture:String,maxFileSize:[Number,String],maxTotalSize:[Number,String],maxFiles:[Number,String],filter:Function},je=["rejected"];function Oe({editable:e,dnd:t,getFileInput:v,addFilesToQueue:I}){const{props:i,emit:n,proxy:o}=me(),y=oe(null),T=b(()=>i.accept!==void 0?i.accept.split(",").map(a=>(a=a.trim(),a==="*"?"*/":(a.endsWith("/*")&&(a=a.slice(0,a.length-1)),a.toUpperCase()))):null),L=b(()=>parseInt(i.maxFiles,10)),M=b(()=>parseInt(i.maxTotalSize,10));function j(a){if(e.value)if(a!==Object(a)&&(a={target:null}),a.target?.matches('input[type="file"]')===!0)a.clientX===0&&a.clientY===0&&ve(a);else{const w=v();w!==a.target&&w?.click(a)}}function O(a){e.value&&a&&I(null,a)}function K(a,w,A,B){let d=Array.from(w||a.target.files);const _=[],k=()=>{_.length!==0&&n("rejected",_)};if(i.accept!==void 0&&T.value.indexOf("*/")===-1&&(d=U(d,_,"accept",c=>T.value.some(h=>c.type.toUpperCase().startsWith(h)||c.name.toUpperCase().endsWith(h))),d.length===0))return k();if(i.maxFileSize!==void 0){const c=parseInt(i.maxFileSize,10);if(d=U(d,_,"max-file-size",h=>h.size<=c),d.length===0)return k()}if(i.multiple!==!0&&d.length!==0&&(d=[d[0]]),d.forEach(c=>{c.__key=c.webkitRelativePath+c.lastModified+c.name+c.size}),B===!0){const c=A.map(h=>h.__key);d=U(d,_,"duplicate",h=>c.includes(h.__key)===!1)}if(d.length===0)return k();if(i.maxTotalSize!==void 0){let c=B===!0?A.reduce((h,H)=>h+H.size,0):0;if(d=U(d,_,"max-total-size",h=>(c+=h.size,c<=M.value)),d.length===0)return k()}if(typeof i.filter=="function"){const c=i.filter(d);d=U(d,_,"filter",h=>c.includes(h))}if(i.maxFiles!==void 0){let c=B===!0?A.length:0;if(d=U(d,_,"max-files",()=>(c++,c<=L.value)),d.length===0)return k()}if(k(),d.length!==0)return d}function X(a){G(a),t.value!==!0&&(t.value=!0)}function m(a){fe(a),(a.relatedTarget!==null||ye.is.safari!==!0?a.relatedTarget!==y.value:document.elementsFromPoint(a.clientX,a.clientY).includes(y.value)===!1)===!0&&(t.value=!1)}function E(a){G(a);const w=a.dataTransfer.files;w.length!==0&&I(null,w),t.value=!1}function Y(a){if(t.value===!0)return Q("div",{ref:y,class:`q-${a}__dnd absolute-full`,onDragenter:G,onDragover:G,onDragleave:m,onDrop:E})}return Object.assign(o,{pickFiles:j,addFiles:O}),{pickFiles:j,addFiles:O,onDragover:X,onDragleave:m,processFiles:K,getDndNode:Y,maxFilesNumber:L,maxTotalSizeNumber:M}}const Ee=xe({name:"QFile",inheritAttrs:!1,props:{...Ie,..._e,...Me,modelValue:[File,FileList,Array],append:Boolean,useChips:Boolean,displayValue:[String,Number],tabindex:{type:[String,Number],default:0},counterLabel:Function,inputClass:[Array,String,Object],inputStyle:[Array,String,Object]},emits:[...be,...je],setup(e,{slots:t,emit:v,attrs:I}){const{proxy:i}=me(),n=Ve(),o=oe(null),y=oe(!1),T=we(e),{pickFiles:L,onDragover:M,onDragleave:j,processFiles:O,getDndNode:K}=Oe({editable:n.editable,dnd:y,getFileInput:se,addFilesToQueue:ie}),X=Ce(e),m=b(()=>Object(e.modelValue)===e.modelValue?"length"in e.modelValue?Array.from(e.modelValue):[e.modelValue]:[]),E=b(()=>le(m.value)),Y=b(()=>m.value.map(u=>u.name).join(", ")),a=b(()=>Ue(m.value.reduce((u,x)=>u+x.size,0))),w=b(()=>({totalSize:a.value,filesNumber:m.value.length,maxFiles:e.maxFiles})),A=b(()=>({tabindex:-1,type:"file",title:"",accept:e.accept,capture:e.capture,name:T.value,...I,id:n.targetUid.value,disabled:n.editable.value!==!0})),B=b(()=>"q-file q-field--auto-height"+(y.value===!0?" q-file--dnd":"")),d=b(()=>e.multiple===!0&&e.append===!0);function _(u){const x=m.value.slice();x.splice(u,1),c(x)}function k(u){const x=m.value.indexOf(u);x!==-1&&_(x)}function c(u){v("update:modelValue",e.multiple===!0?u:u[0])}function h(u){u.keyCode===13&&Pe(u)}function H(u){(u.keyCode===13||u.keyCode===32)&&L(u)}function se(){return o.value}function ie(u,x){const C=O(u,x,m.value,d.value),J=se();J!=null&&(J.value=""),C!==void 0&&((e.multiple===!0?e.modelValue&&C.every(he=>m.value.includes(he)):e.modelValue===C[0])||c(d.value===!0?m.value.concat(C):C))}function R(){return[Q("input",{class:[e.inputClass,"q-file__filler"],style:e.inputStyle})]}function ge(){if(t.file!==void 0)return m.value.length===0?R():m.value.map((x,C)=>t.file({index:C,file:x,ref:this}));if(t.selected!==void 0)return m.value.length===0?R():t.selected({files:m.value,ref:this});if(e.useChips===!0)return m.value.length===0?R():m.value.map((x,C)=>Q(q,{key:"file-"+C,removable:n.editable.value,dense:!0,textColor:e.color,tabindex:e.tabindex,onRemove:()=>{_(C)}},()=>Q("span",{class:"ellipsis",textContent:x.name})));const u=e.displayValue!==void 0?e.displayValue:Y.value;return u.length!==0?[Q("div",{class:e.inputClass,style:e.inputStyle,textContent:u})]:R()}function pe(){const u={ref:o,...A.value,...X.value,class:"q-field__input fit absolute-full cursor-pointer",onChange:ie};return e.multiple===!0&&(u.multiple=!0),Q("input",u)}return Object.assign(n,{fieldClass:B,emitValue:c,hasValue:E,inputRef:o,innerValue:m,floatingLabel:b(()=>E.value===!0||le(e.displayValue)),computedCounter:b(()=>{if(e.counterLabel!==void 0)return e.counterLabel(w.value);const u=e.maxFiles;return`${m.value.length}${u!==void 0?" / "+u:""} (${a.value})`}),getControlChild:()=>K("file"),getControl:()=>{const u={ref:n.targetRef,class:"q-field__native row items-center cursor-pointer",tabindex:e.tabindex};return n.editable.value===!0&&Object.assign(u,{onDragover:M,onDragleave:j,onKeydown:h,onKeyup:H}),Q("div",u,[pe()].concat(ge()))}}),Object.assign(i,{removeAtIndex:_,removeFile:k,getNativeElement:()=>o.value}),Ne(i,"nativeEl",()=>o.value),qe(n)}}),Re={name:"ProductsGrid",data(){return{loading:!1,search:"",categoryId:"all",categories:[{id:"Refrescos y Bebidas",name:"Refrescos y Bebidas",icon:"local_drink",color:"blue"},{id:"Acompañamientos",name:"Acompañamientos",icon:"restaurant",color:"teal"},{id:"Pollos",name:"Pollos",icon:"lunch_dining",color:"brown"}],products:[],dlg:!1,form:{id:null,name:"",categoria:null,description:"",price:0,unit:"UND",active:!0,ord:0,image_url:null},file:null,saving:!1,dlgInsumos:!1,manageProduct:null,insumosProducto:[],insumosOptions:[],nuevoInsumo:{insumo_id:null,cantidad:1},insumosLoading:!1,insumosSaving:!1}},computed:{filtered(){const e=(this.search||"").toLowerCase().trim();return(this.products||[]).filter(t=>{const v=this.categoryId==="all"||t.categoria===this.categoryId,I=!e||String(t.name||"").toLowerCase().includes(e)||String(t.description||"").toLowerCase().includes(e);return v&&I})},subtotalInsumos(){return(this.insumosProducto||[]).reduce((e,t)=>{const v=this.toNum(t.cantidad),I=this.toNum(t.insumo?.costo);return e+v*I},0)}},mounted(){this.fetchProducts()},methods:{toNum(e){if(e==null)return 0;if(typeof e=="number")return isFinite(e)?e:0;const t=String(e).trim().replace(/\s/g,"").replace(/,/g,""),v=Number(t);return isFinite(v)?v:0},toMoney(e){return this.toNum(e).toLocaleString("es-BO",{minimumFractionDigits:2,maximumFractionDigits:2})},utilidad(e){return this.toNum(e?.price)-this.toNum(e?.costo_insumos)},rowTotal(e){const t=this.toNum(e?.cantidad),v=this.toNum(e?.insumo?.costo);return t*v},productImage(e){return`${this.$url}/../storage/${e.image}`},selectCategory(e){this.categoryId=e},async fetchProducts(){this.loading=!0;try{const{data:e}=await this.$axios.get("productos");this.products=Array.isArray(e)?e:[]}catch{this.products=[],this.$q.notify({type:"negative",message:"No se pudieron cargar los productos"})}finally{this.loading=!1}},openNew(){this.form={id:null,name:"",categoria:null,description:"",price:0,unit:"UND",active:!0,ord:0,image_url:null},this.file=null,this.dlg=!0},openEdit(e){this.form={id:e.id,name:e.name,categoria:e.categoria,description:e.description,price:this.toNum(e.price),unit:e.unit||"UND",active:!!e.active,ord:this.toNum(e.ord),image_url:e.image?this.productImage(e):null},this.file=null,this.dlg=!0},async save(){this.saving=!0;try{const e=new FormData;e.append("name",this.form.name),e.append("categoria",this.form.categoria||""),e.append("description",this.form.description||""),e.append("price",this.toNum(this.form.price)),e.append("unit",this.form.unit||"UND"),e.append("active",this.form.active?1:0),e.append("ord",this.toNum(this.form.ord)),this.file&&e.append("image",this.file),this.form.id?(e.append("_method","PUT"),await this.$axios.post(`productos/${this.form.id}`,e,{headers:{"Content-Type":"multipart/form-data"}}),this.$q.notify({type:"positive",message:"Producto actualizado"})):(await this.$axios.post("productos",e,{headers:{"Content-Type":"multipart/form-data"}}),this.$q.notify({type:"positive",message:"Producto creado"})),this.dlg=!1,this.fetchProducts()}catch(e){this.$q.notify({type:"negative",message:e.response?.data?.message||"No se pudo guardar"})}finally{this.saving=!1}},openInsumos(e){this.manageProduct=e,this.dlgInsumos=!0,this.nuevoInsumo={insumo_id:null,cantidad:1},this.fetchInsumosOptions(),this.fetchInsumosProducto()},async fetchInsumosOptions(){try{const{data:e}=await this.$axios.get("insumos");this.insumosOptions=(e||[]).map(t=>({label:`${t.nombre} (${t.unidad||""})`,value:t.id,costo:this.toNum(t.costo),no_contar:this.toNum(t.no_contar),es_mesa:this.toNum(t.es_mesa),es_llevar:this.toNum(t.es_llevar)}))}catch{this.$q.notify({type:"negative",message:"No se pudieron cargar los insumos"})}},async fetchInsumosProducto(){if(this.manageProduct){this.insumosLoading=!0;try{const{data:e}=await this.$axios.get(`productos/${this.manageProduct.id}/insumos`);this.insumosProducto=Array.isArray(e)?e:[]}catch{this.insumosProducto=[]}finally{this.insumosLoading=!1}}},async addInsumoProducto(){if(!(!this.manageProduct||!this.nuevoInsumo.insumo_id)){this.insumosSaving=!0;try{const e={insumo_id:this.nuevoInsumo.insumo_id,cantidad:this.toNum(this.nuevoInsumo.cantidad)};await this.$axios.post(`productos/${this.manageProduct.id}/insumos`,e),await this.fetchInsumosProducto(),this.nuevoInsumo={insumo_id:null,cantidad:1},this.$q.notify({type:"positive",message:"Insumo agregado"})}catch{this.$q.notify({type:"negative",message:"No se pudo agregar el insumo"})}finally{this.insumosSaving=!1}}},async updateInsumoProducto(e){if(!(!this.manageProduct||!e?.id))try{await this.$axios.put(`productos/${this.manageProduct.id}/insumos/${e.id}`,{cantidad:this.toNum(e.cantidad)})}catch{this.$q.notify({type:"negative",message:"No se pudo actualizar"})}},async deleteInsumoProducto(e){!this.manageProduct||!e?.id||this.$q.dialog({title:"Eliminar",message:"¿Quitar este insumo del producto?",cancel:!0,persistent:!0}).onOk(async()=>{try{await this.$axios.delete(`productos/${this.manageProduct.id}/insumos/${e.id}`),this.insumosProducto=this.insumosProducto.filter(t=>t.id!==e.id),this.$q.notify({type:"positive",message:"Insumo eliminado"})}catch{this.$q.notify({type:"negative",message:"No se pudo eliminar"})}})}}},We={class:"row items-center q-gutter-sm q-mb-sm"},Ge={class:"row q-col-gutter-sm q-mb-md"},Ke={class:"col-12"},Xe={class:"row items-center q-gutter-sm"},Ye={class:"row q-col-gutter-md"},He={class:"relative-position",style:{height:"180px",background:"#111"}},Je=["src"],Ze={key:1,class:"full-width full-height flex flex-center text-white"},$e={class:"absolute-bottom-right q-ma-sm bg-red text-white price-tag"},et={class:"text-right"},tt={class:"text-subtitle2"},ot={class:"text-caption"},st={class:"absolute-bottom bg-gradient text-white q-pa-sm"},it={class:"text-subtitle2 text-weight-bold ellipsis-2-lines"},lt={class:"row items-center"},nt={class:"text-caption text-grey"},at={class:"row items-center q-mt-xs"},rt={class:"text-caption"},ut={class:"text-right"},dt={key:0,class:"col-12"},ct={class:"text-subtitle1"},mt={class:"row q-col-gutter-sm"},ft={class:"col-12 col-md-8"},gt={class:"col-12 col-md-4"},pt={class:"col-6"},ht={class:"col-6"},vt={class:"col-12"},yt={class:"col-12"},xt={key:0,class:"q-mt-sm"},bt=["src"],_t={class:"col-6"},It={class:"col-6"},Vt={class:"text-right q-mt-md"},wt={class:"text-subtitle1"},Ct={class:"text-left"},Nt={class:"text-weight-medium"},qt={class:"row q-gutter-xs q-mt-xs"},Pt={class:"text-left"},kt={class:"text-right"},St={class:"text-right"},Ft={class:"text-right text-weight-bold"},Qt={class:"text-right"},zt={key:0},Ut={class:"text-right text-weight-bold text-primary"},At={class:"q-mt-md"},Bt={class:"row q-col-gutter-sm items-center"},Dt={class:"col-12 col-md-6"},Tt={class:"row q-gutter-xs q-mt-xs"},Lt={class:"text-weight-bold"},Mt={class:"col-6 col-md-3"},jt={class:"col-6 col-md-3"};function Ot(e,t,v,I,i,n){return f(),S(Le,{class:"q-pa-md bg-grey-3"},{default:r(()=>[s("div",We,[l(V,{flat:"",round:"",dense:"",icon:"menu",class:"lt-md"}),t[17]||(t[17]=s("div",{class:"text-h6 text-weight-bold"},"Productos",-1)),l(D),l(V,{flat:"",round:"",dense:"",icon:"refresh",onClick:n.fetchProducts,title:"Actualizar lista de productos",class:"q-mr-sm"},null,8,["onClick"]),l(V,{color:"positive",icon:"add_circle",label:"Nuevo","no-caps":"",onClick:n.openNew,class:"q-mr-sm"},null,8,["onClick"]),l(F,{modelValue:i.search,"onUpdate:modelValue":t[0]||(t[0]=o=>i.search=o),dense:"",outlined:"",debounce:"250",placeholder:"Buscar producto...",style:{width:"260px"},clearable:""},{prepend:r(()=>[l(Z,{name:"search"})]),_:1},8,["modelValue"])]),s("div",Ge,[s("div",Ke,[s("div",Xe,[l(q,{clickable:"",color:i.categoryId==="all"?"indigo":"grey-4","text-color":i.categoryId==="all"?"white":"black",onClick:t[1]||(t[1]=o=>n.selectCategory("all")),icon:"public"},{default:r(()=>[...t[18]||(t[18]=[p("Todo",-1)])]),_:1},8,["color","text-color"]),(f(!0),N($,null,ee(i.categories,o=>(f(),S(q,{key:o.id,clickable:"",color:i.categoryId===o.id?o.color||"indigo":"grey-4","text-color":i.categoryId===o.id?"white":"black",onClick:y=>n.selectCategory(o.id),icon:o.icon||"category"},{default:r(()=>[p(g(o.name),1)]),_:2},1032,["color","text-color","onClick","icon"]))),128))])])]),s("div",Ye,[(f(!0),N($,null,ee(n.filtered,o=>(f(),N("div",{key:o.id,class:"col-12 col-sm-6 col-md-4 col-lg-3"},[l(W,{class:"overflow-hidden hoverable"},{default:r(()=>[s("div",He,[o.image?(f(),N("img",{key:0,src:n.productImage(o),alt:"img",style:{width:"100%",height:"100%","object-fit":"cover"},loading:"lazy"},null,8,Je)):(f(),N("div",Ze,[l(Z,{name:"image",size:"56px"})])),s("div",$e,[s("div",et,[t[19]||(t[19]=s("div",{class:"text-caption"},"Venta",-1)),s("div",tt,g(n.toMoney(o.price))+" Bs",1),s("div",ot," Costo: "+g(n.toMoney(o.costo_insumos||0))+" Bs ",1)])]),s("div",st,[s("div",it,g(o.name),1)])]),l(z,{class:"q-py-xs"},{default:r(()=>[s("div",lt,[l(re,{outline:"",color:"grey-7",class:"q-mr-sm"},{default:r(()=>[p(g(o.unit||"UND"),1)]),_:2},1024),s("div",nt,g(o.categoria||"—"),1),l(D),l(V,{dense:"",round:"",flat:"",icon:"edit",onClick:te(y=>n.openEdit(o),["stop"])},null,8,["onClick"]),l(V,{dense:"",round:"",flat:"",icon:"inventory_2",class:"q-ml-xs",onClick:te(y=>n.openInsumos(o),["stop"]),title:"Insumos del producto"},null,8,["onClick"])]),s("div",at,[s("div",null,[t[20]||(t[20]=s("div",{class:"text-caption text-grey-7"},"Costo aprox.",-1)),s("div",rt,g(n.toMoney(o.costo_insumos||0))+" Bs ",1)]),l(D),s("div",ut,[t[21]||(t[21]=s("div",{class:"text-caption text-grey-7"},"Utilidad aprox.",-1)),s("div",{class:Se(["text-caption",n.utilidad(o)>=0?"text-positive":"text-negative"])},g(n.toMoney(n.utilidad(o)))+" Bs ",3)])])]),_:2},1024)]),_:2},1024)]))),128)),!i.loading&&!n.filtered.length?(f(),N("div",dt,[l(W,{flat:"",bordered:""},{default:r(()=>[l(z,{class:"text-center text-grey"},{default:r(()=>[...t[22]||(t[22]=[p("Sin resultados",-1)])]),_:1})]),_:1})])):P("",!0)]),l(ue,{showing:i.loading},{default:r(()=>[l(ne,{size:"50px"})]),_:1},8,["showing"]),l(ae,{modelValue:i.dlg,"onUpdate:modelValue":t[12]||(t[12]=o=>i.dlg=o),persistent:""},{default:r(()=>[l(W,{style:{width:"680px","max-width":"95vw"}},{default:r(()=>[l(z,{class:"row items-center q-pb-none"},{default:r(()=>[s("div",ct,g(i.form.id?"Editar producto":"Nuevo producto"),1),l(D),l(V,{flat:"",round:"",dense:"",icon:"close",onClick:t[2]||(t[2]=o=>i.dlg=!1)})]),_:1}),l(z,{class:"q-pt-none"},{default:r(()=>[l(Ae,{onSubmit:te(n.save,["prevent"])},{default:r(()=>[s("div",mt,[s("div",ft,[l(F,{modelValue:i.form.name,"onUpdate:modelValue":t[3]||(t[3]=o=>i.form.name=o),label:"Nombre",dense:"",outlined:"",rules:[o=>!!o||"Requerido"]},null,8,["modelValue","rules"])]),s("div",gt,[l(de,{modelValue:i.form.categoria,"onUpdate:modelValue":t[4]||(t[4]=o=>i.form.categoria=o),dense:"",outlined:"",label:"Categoría",options:i.categories.map(o=>o.id),rules:[o=>!!o||"Requerido"]},null,8,["modelValue","options","rules"])]),s("div",pt,[l(F,{modelValue:i.form.price,"onUpdate:modelValue":t[5]||(t[5]=o=>i.form.price=o),modelModifiers:{number:!0},type:"number",step:"0.01",label:"Precio (Bs)",dense:"",outlined:"",rules:[o=>n.toNum(o)>=0||"≥ 0"]},null,8,["modelValue","rules"])]),s("div",ht,[l(F,{modelValue:i.form.unit,"onUpdate:modelValue":t[6]||(t[6]=o=>i.form.unit=o),label:"Unidad (ej: UND, KG, LT)",dense:"",outlined:""},null,8,["modelValue"])]),s("div",vt,[l(F,{modelValue:i.form.description,"onUpdate:modelValue":t[7]||(t[7]=o=>i.form.description=o),type:"textarea",autogrow:"",label:"Descripción",dense:"",outlined:""},null,8,["modelValue"])]),s("div",yt,[l(Ee,{modelValue:i.file,"onUpdate:modelValue":t[8]||(t[8]=o=>i.file=o),label:"Imagen",dense:"",outlined:"",accept:".png,.jpg,.jpeg,.webp",counter:""},{prepend:r(()=>[l(Z,{name:"image"})]),_:1},8,["modelValue"]),i.form.image_url?(f(),N("div",xt,[s("img",{src:i.form.image_url,alt:"preview",style:{"max-width":"160px","border-radius":"8px"}},null,8,bt)])):P("",!0)]),s("div",_t,[l(Fe,{modelValue:i.form.active,"onUpdate:modelValue":t[9]||(t[9]=o=>i.form.active=o),label:"Activo"},null,8,["modelValue"])]),s("div",It,[l(F,{modelValue:i.form.ord,"onUpdate:modelValue":t[10]||(t[10]=o=>i.form.ord=o),modelModifiers:{number:!0},type:"number",label:"Orden",dense:"",outlined:""},null,8,["modelValue"])])]),s("div",Vt,[l(V,{flat:"",color:"negative",label:"Cancelar","no-caps":"",onClick:t[11]||(t[11]=o=>i.dlg=!1)}),l(V,{color:"primary",label:"Guardar","no-caps":"",class:"q-ml-sm",type:"submit",loading:i.saving},null,8,["loading"])])]),_:1},8,["onSubmit"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(ae,{modelValue:i.dlgInsumos,"onUpdate:modelValue":t[16]||(t[16]=o=>i.dlgInsumos=o),persistent:""},{default:r(()=>[l(W,{style:{width:"900px","max-width":"95vw"}},{default:r(()=>[l(z,{class:"row items-center q-pb-none"},{default:r(()=>[s("div",wt,[t[23]||(t[23]=p(" Insumos de: ",-1)),s("b",null,g(i.manageProduct?.name||""),1)]),l(D),l(q,{dense:"",color:"primary","text-color":"white",icon:"summarize",class:"q-mr-sm"},{default:r(()=>[p(" Subtotal: "+g(n.toMoney(n.subtotalInsumos))+" Bs ",1)]),_:1}),l(V,{flat:"",round:"",dense:"",icon:"close",onClick:t[13]||(t[13]=o=>i.dlgInsumos=!1)})]),_:1}),l(z,{class:"q-pt-none"},{default:r(()=>[l(Be,{dense:"",flat:"",bordered:"",separator:"horizontal"},{default:r(()=>[t[30]||(t[30]=s("thead",null,[s("tr",null,[s("th",{class:"text-left"},"Insumo"),s("th",{class:"text-left",style:{width:"90px"}},"Unidad"),s("th",{class:"text-right",style:{width:"140px"}},"Cantidad"),s("th",{class:"text-right",style:{width:"120px"}},"Costo"),s("th",{class:"text-right",style:{width:"140px"}},"Total"),s("th",{class:"text-right",style:{width:"70px"}})])],-1)),s("tbody",null,[(f(!0),N($,null,ee(i.insumosProducto,o=>(f(),N("tr",{key:o.id},[s("td",Ct,[s("div",Nt,g(o.insumo?.nombre||""),1),s("div",qt,[Number(o.insumo?.no_contar)===1?(f(),S(q,{key:0,dense:"",color:"grey-8","text-color":"white",icon:"do_not_disturb_on"},{default:r(()=>[...t[24]||(t[24]=[p(" No contar ",-1)])]),_:1})):P("",!0),Number(o.insumo?.es_mesa)===1?(f(),S(q,{key:1,dense:"",color:"indigo","text-color":"white",icon:"table_restaurant"},{default:r(()=>[...t[25]||(t[25]=[p(" MESA ",-1)])]),_:1})):P("",!0),Number(o.insumo?.es_llevar)===1?(f(),S(q,{key:2,dense:"",color:"deep-orange","text-color":"white",icon:"takeout_dining"},{default:r(()=>[...t[26]||(t[26]=[p(" LLEVAR ",-1)])]),_:1})):P("",!0)])]),s("td",Pt,[l(re,{outline:"",color:"grey-7"},{default:r(()=>[p(g(o.insumo?.unidad||"—"),1)]),_:2},1024)]),s("td",kt,[l(F,{modelValue:o.cantidad,"onUpdate:modelValue":y=>o.cantidad=y,modelModifiers:{number:!0},type:"number",step:"0.01",dense:"",outlined:"",style:{"max-width":"120px","margin-left":"auto"},onBlur:y=>n.updateInsumoProducto(o)},null,8,["modelValue","onUpdate:modelValue","onBlur"])]),s("td",St,g(n.toMoney(o.insumo?.costo||0)),1),s("td",Ft,g(n.toMoney(n.rowTotal(o))),1),s("td",Qt,[l(V,{dense:"",round:"",flat:"",icon:"delete",color:"negative",onClick:y=>n.deleteInsumoProducto(o)},null,8,["onClick"])])]))),128)),!i.insumosLoading&&i.insumosProducto.length===0?(f(),N("tr",zt,[...t[27]||(t[27]=[s("td",{colspan:"6",class:"text-center text-grey q-pa-md"}," Este producto no tiene insumos. ",-1)])])):P("",!0)]),s("tfoot",null,[s("tr",null,[t[28]||(t[28]=s("td",{colspan:"4",class:"text-right text-grey-7"}," SUBTOTAL ",-1)),s("td",Ut,g(n.toMoney(n.subtotalInsumos))+" Bs ",1),t[29]||(t[29]=s("td",null,null,-1))])])]),_:1}),l(ue,{showing:i.insumosLoading},{default:r(()=>[l(ne,{size:"40px"})]),_:1},8,["showing"]),s("div",At,[t[35]||(t[35]=s("div",{class:"text-subtitle2 q-mb-xs"},"Agregar insumo",-1)),s("div",Bt,[s("div",Dt,[l(de,{modelValue:i.nuevoInsumo.insumo_id,"onUpdate:modelValue":t[14]||(t[14]=o=>i.nuevoInsumo.insumo_id=o),options:i.insumosOptions,label:"Insumo",dense:"",outlined:"","emit-value":"","map-options":"","use-input":"","fill-input":"","input-debounce":"200",behavior:"menu"},{option:r(o=>[l(De,Qe(ze(o.itemProps)),{default:r(()=>[l(ce,null,{default:r(()=>[l(Te,{class:"text-weight-medium"},{default:r(()=>[p(g(o.opt.label),1)]),_:2},1024),s("div",Tt,[Number(o.opt.no_contar)===1?(f(),S(q,{key:0,dense:"",color:"grey-8","text-color":"white"},{default:r(()=>[...t[31]||(t[31]=[p("No contar",-1)])]),_:1})):P("",!0),Number(o.opt.es_mesa)===1?(f(),S(q,{key:1,dense:"",color:"indigo","text-color":"white"},{default:r(()=>[...t[32]||(t[32]=[p("MESA",-1)])]),_:1})):P("",!0),Number(o.opt.es_llevar)===1?(f(),S(q,{key:2,dense:"",color:"deep-orange","text-color":"white"},{default:r(()=>[...t[33]||(t[33]=[p("LLEVAR",-1)])]),_:1})):P("",!0)])]),_:2},1024),l(ce,{side:"",top:"",class:"text-right"},{default:r(()=>[t[34]||(t[34]=s("div",{class:"text-caption text-grey-7"},"Costo",-1)),s("div",Lt,g(n.toMoney(o.opt.costo||0)),1)]),_:2},1024)]),_:2},1040)]),_:1},8,["modelValue","options"])]),s("div",Mt,[l(F,{modelValue:i.nuevoInsumo.cantidad,"onUpdate:modelValue":t[15]||(t[15]=o=>i.nuevoInsumo.cantidad=o),modelModifiers:{number:!0},type:"number",dense:"",outlined:"",step:"0.01",label:"Cantidad"},null,8,["modelValue"])]),s("div",jt,[l(V,{color:"primary",label:"Agregar","no-caps":"",class:"full-width",loading:i.insumosSaving,onClick:n.addInsumoProducto},null,8,["loading","onClick"])])])]),t[36]||(t[36]=s("div",{class:"text-caption text-grey-7 q-mt-sm"},[p(" * Si tu costo te sale gigante (ej 2.460 Bs), revisa: "),s("b",null,"insumo.costo"),p(" (que sea costo por unidad) y "),s("b",null,"cantidad"),p(" (que sea la porción real: 0.20, 0.05, etc.). ")],-1))]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}const to=ke(Re,[["render",Ot],["__scopeId","data-v-d662e5f3"]]);export{to as default};
