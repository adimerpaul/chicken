import{v as ne,F as se,ak as ue,aj as le,G as ie,H as re,g as ce,r as w,x as r,J as fe,al as de,a3 as ve,am as ge,L as he,an as me,p as D,b3 as Te,b4 as A,b5 as Pe,$ as Se,b6 as be,ao as ke,b7 as ye,b8 as xe,j as R,y as Be,T as Ce,m as Oe,b9 as qe,S as Ee}from"./index-Bwutk4ap.js";import{v as Fe,a as H,f as Me,b as we,d as De,p as K,e as Ae,r as $,s as Re}from"./position-engine-CRuj33S7.js";const $e=ne({name:"QMenu",inheritAttrs:!1,props:{...Me,...re,...ie,...le,persistent:Boolean,autoClose:Boolean,separateClosePopup:Boolean,noEscDismiss:Boolean,noRouteDismiss:Boolean,noRefocus:Boolean,noFocus:Boolean,fit:Boolean,cover:Boolean,square:Boolean,anchor:{type:String,validator:H},self:{type:String,validator:H},offset:{type:Array,validator:Fe},scrollTarget:ue,touchPosition:Boolean,maxHeight:{type:String,default:null},maxWidth:{type:String,default:null}},emits:[...se,"click","escapeKey"],setup(e,{slots:o,emit:a,attrs:l}){let n=null,v,c,g;const b=ce(),{proxy:h}=b,{$q:s}=h,u=w(null),i=w(!1),z=r(()=>e.persistent!==!0&&e.noRouteDismiss!==!0),I=fe(e,s),{registerTick:Q,removeTick:W}=de(),{registerTimeout:k}=ve(),{transitionProps:G,transitionStyle:L}=ge(e),{localScrollTarget:y,changeScrollEvent:_,unconfigureScrollTarget:J}=we(e,F),{anchorEl:f,canShow:U}=De({showing:i}),{hide:x}=he({showing:i,canShow:U,handleShow:Z,handleHide:p,hideOnRouteChange:z,processOnMount:!0}),{showPortal:B,hidePortal:C,renderPortal:N}=me(b,u,te,"menu"),m={anchorEl:f,innerRef:u,onClickOutside(t){if(e.persistent!==!0&&i.value===!0)return x(t),(t.type==="touchstart"||t.target.classList.contains("q-dialog__backdrop"))&&Ee(t),!0}},O=r(()=>K(e.anchor||(e.cover===!0?"center middle":"bottom start"),s.lang.rtl)),V=r(()=>e.cover===!0?O.value:K(e.self||"top start",s.lang.rtl)),X=r(()=>(e.square===!0?" q-menu--square":"")+(I.value===!0?" q-menu--dark q-dark":"")),Y=r(()=>e.autoClose===!0?{onClick:ee}:{}),q=r(()=>i.value===!0&&e.persistent!==!0);D(q,t=>{t===!0?(Te(P),Ae(m)):(A(P),$(m))});function T(){qe(()=>{let t=u.value;t&&t.contains(document.activeElement)!==!0&&(t=t.querySelector("[autofocus][tabindex], [data-autofocus][tabindex]")||t.querySelector("[autofocus] [tabindex], [data-autofocus] [tabindex]")||t.querySelector("[autofocus], [data-autofocus]")||t,t.focus({preventScroll:!0}))})}function Z(t){if(n=e.noRefocus===!1?document.activeElement:null,Pe(M),B(),F(),v=void 0,t!==void 0&&(e.touchPosition||e.contextMenu)){const S=Se(t);if(S.left!==void 0){const{top:oe,left:ae}=f.value.getBoundingClientRect();v={left:S.left-ae,top:S.top-oe}}}c===void 0&&(c=D(()=>s.screen.width+"|"+s.screen.height+"|"+e.self+"|"+e.anchor+"|"+s.lang.rtl,d)),e.noFocus!==!0&&document.activeElement.blur(),Q(()=>{d(),e.noFocus!==!0&&T()}),k(()=>{s.platform.is.ios===!0&&(g=e.autoClose,u.value.click()),d(),B(!0),a("show",t)},e.transitionDuration)}function p(t){W(),C(),E(!0),n!==null&&(t===void 0||t.qClickOutside!==!0)&&(((t?.type.indexOf("key")===0?n.closest('[tabindex]:not([tabindex^="-"])'):void 0)||n).focus(),n=null),k(()=>{C(!0),a("hide",t)},e.transitionDuration)}function E(t){v=void 0,c!==void 0&&(c(),c=void 0),(t===!0||i.value===!0)&&(be(M),J(),$(m),A(P)),t!==!0&&(n=null)}function F(){(f.value!==null||e.scrollTarget!==void 0)&&(y.value=ke(f.value,e.scrollTarget),_(y.value,d))}function ee(t){g!==!0?(ye(h,t),a("click",t)):g=!1}function M(t){q.value===!0&&e.noFocus!==!0&&xe(u.value,t.target)!==!0&&T()}function P(t){e.noEscDismiss!==!0&&(a("escapeKey"),x(t))}function d(){Re({targetEl:u.value,offset:e.offset,anchorEl:f.value,anchorOrigin:O.value,selfOrigin:V.value,absoluteOffset:v,fit:e.fit,cover:e.cover,maxHeight:e.maxHeight,maxWidth:e.maxWidth})}function te(){return R(Ce,G.value,()=>i.value===!0?R("div",{role:"menu",...l,ref:u,tabindex:-1,class:["q-menu q-position-engine scroll"+X.value,l.class],style:[l.style,L.value],...Y.value},Be(o.default)):null)}return Oe(E),Object.assign(h,{focus:T,updatePosition:d}),N}}),j=["B","KB","MB","GB","TB","PB"];function je(e,o=1){let a=0;for(;parseInt(e,10)>=1024&&a<j.length-1;)e/=1024,++a;return`${e.toFixed(o)}${j[a]}`}function ze(e,o,a){return a<=o?o:Math.min(a,Math.max(o,e))}function Ie(e,o,a){if(a<=o)return o;const l=a-o+1;let n=o+(e-o)%l;return n<o&&(n=l+n),n===0?0:n}export{$e as Q,ze as b,je as h,Ie as n};
