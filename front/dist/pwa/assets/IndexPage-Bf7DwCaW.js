import{_ as y,c as g,o as u,w as a,a7 as k,a as o,b as e,Q as d,e as r,af as v,f as c,O as f,t as p,a8 as b,a9 as x}from"./index-VgD-d_Hk.js";import{Q as w}from"./QSpace-BxhzS17a.js";import{Q as C}from"./QTooltip-W7rQyMO-.js";import{Q as D}from"./QPage-DPxtIxUh.js";import"./position-engine-D7bNVPtY.js";const N={name:"IndexPage",data(){return{loading:!1,fullScreenChart:!1,filters:{date_from:"",date_to:""},kpis:{ingresos:0,egresos:0,neto:0,ventas:0,items:0,ticket_promedio:0},porDia:[],pagos:[],chartVentas:{series:[],options:{}},chartPagos:{series:[],options:{}}}},mounted(){this.prefillDates(),this.fetchDashboard()},methods:{prefillDates(){const l=new Date,t=l.getFullYear(),i=String(l.getMonth()+1).padStart(2,"0"),h=`${t}-${i}-01`,s=`${t}-${i}-${String(new Date(t,l.getMonth()+1,0).getDate()).padStart(2,"0")}`;this.filters.date_from=h,this.filters.date_to=s},async fetchDashboard(){this.loading=!0;try{const l={...this.filters},{data:t}=await this.$axios.get("reportes/ventas",{params:l});this.kpis=t?.kpis||this.kpis,this.porDia=t?.por_dia||[],this.pagos=t?.pagos||[],this.buildChartVentas(),this.buildChartPagos()}catch(l){const t=l?.response?.data?.message||"No se pudo cargar el dashboard";this.$q.notify?.({type:"negative",message:t})}finally{this.loading=!1}},buildChartVentas(){const l=this.porDia.map(s=>s.date),t=this.porDia.map(s=>Number(s.ingreso||0)),i=this.porDia.map(s=>Number(s.egreso||0)),h=this.porDia.map(s=>Number(s.neto||0));this.chartVentas={series:[{name:"Ingresos",data:t},{name:"Egresos",data:i},{name:"Neto",data:h}],options:{chart:{type:"bar",toolbar:{show:!1}},dataLabels:{enabled:!1},stroke:{curve:"smooth",width:2},xaxis:{categories:l,labels:{rotate:-45}},yaxis:{labels:{formatter:s=>Number(s||0).toFixed(0)}},legend:{position:"top"},tooltip:{y:{formatter:s=>this.money(s)+" Bs"}}}}},buildChartPagos(){const l=this.pagos.map(i=>i.pago||"SN"),t=this.pagos.map(i=>Number(i.total||0));this.chartPagos={series:t,options:{labels:l,legend:{position:"bottom"},tooltip:{y:{formatter:i=>this.money(i)+" Bs"}}}}},money(l){return Number(l||0).toLocaleString("es-BO",{minimumFractionDigits:2,maximumFractionDigits:2})}}},V={class:"row items-center q-col-gutter-sm"},S={class:"col-12 col-sm-3"},B={class:"col-12 col-sm-3"},Q={class:"col-12 col-sm-3 col-md-2"},P={class:"row q-col-gutter-sm"},q={class:"col-6 col-sm-3"},I={class:"col-6 col-sm-3"},E={class:"col-6 col-sm-3"},F={class:"col-6 col-sm-3"},M={class:"row q-col-gutter-md q-mb-md"},R={class:"col-12 col-sm-6 col-md-3"},T={class:"text-h5 text-weight-bold"},L={class:"col-12 col-sm-6 col-md-3"},O={class:"text-h5 text-weight-bold"},U={class:"col-12 col-sm-6 col-md-3"},j={class:"text-h5 text-weight-bold"},z={class:"text-caption text-grey"},A={class:"col-12 col-sm-6 col-md-3"},H={class:"text-h5 text-weight-bold"},Y={class:"text-caption text-grey"},G={class:"row q-col-gutter-md"},J={class:"col-12 col-md-8"},K={key:1,class:"text-grey text-center q-pa-md text-caption"},W={class:"col-12 col-md-4"},X={key:1,class:"text-grey text-center q-pa-md text-caption"};function Z(l,t,i,h,s,m){const _=k("apexchart");return u(),g(D,{class:"q-pa-md bg-grey-3"},{default:a(()=>[o(d,{flat:"",bordered:"",class:"q-mb-md"},{default:a(()=>[o(r,null,{default:a(()=>[e("div",V,[t[7]||(t[7]=e("div",{class:"col-12 col-md-6"},[e("div",{class:"text-h5 text-weight-bold"}," Dashboard general "),e("div",{class:"text-caption text-grey-7"}," Resumen rápido de ventas, caja e insumos ")],-1)),e("div",S,[o(v,{modelValue:s.filters.date_from,"onUpdate:modelValue":t[0]||(t[0]=n=>s.filters.date_from=n),type:"date",label:"Desde",dense:"",outlined:""},null,8,["modelValue"])]),e("div",B,[o(v,{modelValue:s.filters.date_to,"onUpdate:modelValue":t[1]||(t[1]=n=>s.filters.date_to=n),type:"date",label:"Hasta",dense:"",outlined:""},null,8,["modelValue"])]),e("div",Q,[o(c,{color:"primary",icon:"refresh",label:"Actualizar","no-caps":"",class:"full-width",loading:s.loading,onClick:m.fetchDashboard},null,8,["loading","onClick"])])])]),_:1}),o(f),o(r,null,{default:a(()=>[e("div",P,[e("div",q,[o(c,{color:"primary",icon:"point_of_sale",label:"Nueva venta","no-caps":"",class:"full-width",onClick:t[2]||(t[2]=n=>l.$router.push({path:"/ventas"}))})]),e("div",I,[o(c,{color:"teal",icon:"shopping_cart",label:"Nueva compra","no-caps":"",class:"full-width",onClick:t[3]||(t[3]=n=>l.$router.push({path:"/compras"}))})]),e("div",E,[o(c,{color:"indigo",icon:"inventory_2",label:"Productos","no-caps":"",class:"full-width",onClick:t[4]||(t[4]=n=>l.$router.push({path:"/productos"}))})]),e("div",F,[o(c,{color:"orange",outline:"",icon:"insights",label:"Reportes detallados","no-caps":"",class:"full-width",onClick:t[5]||(t[5]=n=>l.$router.push({path:"/reportes"}))})])])]),_:1})]),_:1}),e("div",M,[e("div",R,[o(d,{flat:"",bordered:"",class:"kpi kpi-green"},{default:a(()=>[o(r,null,{default:a(()=>[t[8]||(t[8]=e("div",{class:"text-caption text-positive"},"Ingresos",-1)),e("div",T,p(m.money(s.kpis.ingresos))+" Bs ",1)]),_:1})]),_:1})]),e("div",L,[o(d,{flat:"",bordered:"",class:"kpi kpi-red"},{default:a(()=>[o(r,null,{default:a(()=>[t[9]||(t[9]=e("div",{class:"text-caption text-negative"},"Egresos",-1)),e("div",O,p(m.money(s.kpis.egresos))+" Bs ",1)]),_:1})]),_:1})]),e("div",U,[o(d,{flat:"",bordered:"",class:"kpi kpi-indigo"},{default:a(()=>[o(r,null,{default:a(()=>[t[10]||(t[10]=e("div",{class:"text-caption"},"Neto",-1)),e("div",j,p(m.money(s.kpis.neto))+" Bs ",1),e("div",z," Ticket prom.: "+p(m.money(s.kpis.ticket_promedio))+" Bs ",1)]),_:1})]),_:1})]),e("div",A,[o(d,{flat:"",bordered:"",class:"kpi"},{default:a(()=>[o(r,null,{default:a(()=>[t[11]||(t[11]=e("div",{class:"text-caption"},"Resumen de ventas",-1)),e("div",H,p(s.kpis.ventas)+" ventas ",1),e("div",Y," Ítems vendidos: "+p(s.kpis.items),1)]),_:1})]),_:1})])]),e("div",G,[e("div",J,[o(d,{flat:"",bordered:""},{default:a(()=>[o(r,{class:"row items-center"},{default:a(()=>[t[13]||(t[13]=e("div",{class:"text-subtitle1 text-weight-bold"}," Movimiento diario (Ingresos vs Egresos vs Neto) ",-1)),o(w),o(c,{dense:"",flat:"",icon:"fullscreen",round:"",onClick:t[6]||(t[6]=n=>s.fullScreenChart=!s.fullScreenChart)},{default:a(()=>[o(C,null,{default:a(()=>[...t[12]||(t[12]=[b(" Cambiar tamaño ",-1)])]),_:1})]),_:1})]),_:1}),o(f),o(r,null,{default:a(()=>[s.chartVentas.series.length?(u(),g(_,{key:0,type:"bar",height:"320",options:s.chartVentas.options,series:s.chartVentas.series},null,8,["options","series"])):(u(),x("div",K," No hay datos en el rango seleccionado. "))]),_:1})]),_:1})]),e("div",W,[o(d,{flat:"",bordered:""},{default:a(()=>[o(r,{class:"text-subtitle1 text-weight-bold"},{default:a(()=>[...t[14]||(t[14]=[b(" Ventas por tipo de pago ",-1)])]),_:1}),o(f),o(r,null,{default:a(()=>[s.chartPagos.series.length?(u(),g(_,{key:0,type:"donut",height:"320",options:s.chartPagos.options,series:s.chartPagos.series},null,8,["options","series"])):(u(),x("div",X," No hay ventas por tipo de pago en este rango. "))]),_:1})]),_:1})])])]),_:1})}const at=y(N,[["render",Z],["__scopeId","data-v-9e938618"]]);export{at as default};
